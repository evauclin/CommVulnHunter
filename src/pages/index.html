<!doctype html>
<html lang="en">
  <!--begin::Head-->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Email Filter</title>
    <!--begin::Fonts-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css"
      integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q="
      crossorigin="anonymous"
    />
    <!--end::Fonts-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css"
      integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg="
      crossorigin="anonymous"
    />
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    <!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI="
      crossorigin="anonymous"
    />
    <!--end::Third Party Plugin(Bootstrap Icons)-->
    <!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="../css/adminlte.css" />
    <!--end::Required Plugin(AdminLTE)-->
    <!-- apexcharts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css"
      integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0="
      crossorigin="anonymous"
    />
    <!-- jsvectormap -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css"
      integrity="sha256-+uGLJmmTKOqBr+2E6KDYs/NRsHxSkONXFHUL0fy2O/4="
      crossorigin="anonymous"
    />
  </head>
  <!--end::Head-->
  <!--begin::Body-->
  <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <!--begin::App Wrapper-->
    <div class="app-wrapper">
      <!--begin::Header-->
      <nav class="app-header navbar navbar-expand bg-body">
        <!--begin::Container-->
        <div class="container-fluid">
          <!--begin::Start Navbar Links-->
          <ul class="navbar-nav">
            <li class="nav-item d-none d-md-block"><a href="#" class="nav-link">Home</a></li>
          </ul>
          <!--end::Start Navbar Links-->
          <!--begin::End Navbar Links-->
          <ul class="navbar-nav ms-auto">
            
            
            
            <!--begin::Fullscreen Toggle-->
            <li class="nav-item">
              <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i>
                <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none"></i>
              </a>
            </li>
            <!--end::Fullscreen Toggle-->
            
          </ul>
          <!--end::End Navbar Links-->
        </div>
        <!--end::Container-->
      </nav>
      <!--end::Header-->
      
      </aside>
      <!--end::Sidebar-->
      <!--begin::App Main-->
      <main class="app-main">
        <!--begin::App Content Header-->
        <div class="app-content-header">
          <!--begin::Container-->
          <div class="container-fluid">
            <!--begin::Row-->
            <div class="row">
              <div class="col-sm-6"><h3 class="mb-0">Dashboard</h3></div>
              <div class="col-sm-6">
                
              </div>
            </div>
            <!--end::Row-->
          </div>
          <!--end::Container-->
        </div>
        <!--end::App Content Header-->
        <!--begin::App Content-->
        <div class="app-content">
          <!--begin::Container-->
          <div class="container-fluid">
            <!--begin::Row-->
            <div class="row">
              <!--begin::Col-->
              <div class="col-lg-4 col-md-6">
                <!--begin::Small Box Widget 1-->
                <div class="small-box text-bg-primary">
                  <div class="inner">
                    <h3>XX</h3>
                    <p>Emails analysés</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      d="M2.25 2.25a.75.75 0 000 1.5h1.386c.17 0 .318.114.362.278l2.558 9.592a3.752 3.752 0 00-2.806 3.63c0 .414.336.75.75.75h15.75a.75.75 0 000-1.5H5.378A2.25 2.25 0 017.5 15h11.218a.75.75 0 00.674-.421 60.358 60.358 0 002.96-7.228.75.75 0 00-.525-.965A60.864 60.864 0 005.68 4.509l-.232-.867A1.875 1.875 0 003.636 2.25H2.25zM3.75 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM16.5 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"
                    ></path>
                  </svg>
                   
                  </a>
                </div>
                <!--end::Small Box Widget 1-->
              </div>
              <!--end::Col-->
              <div class="col-lg-4 col-md-6">
                <!--begin::Small Box Widget 2-->
                <div class="small-box text-bg-success">
                  <div class="inner">
                    <h3>53<sup class="fs-5">%</sup></h3>
                    <p>Taux de réussite</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      d="M18.375 2.25c-1.035 0-1.875.84-1.875 1.875v15.75c0 1.035.84 1.875 1.875 1.875h.75c1.035 0 1.875-.84 1.875-1.875V4.125c0-1.036-.84-1.875-1.875-1.875h-.75zM9.75 8.625c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-.75a1.875 1.875 0 01-1.875-1.875V8.625zM3 13.125c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v6.75c0 1.035-.84 1.875-1.875 1.875h-.75A1.875 1.875 0 013 19.875v-6.75z"
                    ></path>
                  </svg>
                
                </div>
                <!--end::Small Box Widget 2-->
              </div>
             
              <div class="col-lg-4 col-md-6">
                <!--begin::Small Box Widget 3-->
                <div class="small-box text-bg-danger">
                  <div class="inner">
                    <h3>XX</h3>
                    <p> Spams détéctés</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      clip-rule="evenodd"
                      fill-rule="evenodd"
                      d="M2.25 13.5a8.25 8.25 0 018.25-8.25.75.75 0 01.75.75v6.75H18a.75.75 0 01.75.75 8.25 8.25 0 01-16.5 0z"
                    ></path>
                    <path
                      clip-rule="evenodd"
                      fill-rule="evenodd"
                      d="M12.75 3a.75.75 0 01.75-.75 8.25 8.25 0 018.25 8.25.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75V3z"
                    ></path>
                  </svg>
                  
                  </a>
                </div>
                <!--end::Small Box Widget 3-->
              </div>
              <!--end::Col-->
            </div>
            <!--end::Row-->
            <!--begin::Row-->
            <div class="row">

<div class="row">
  <!-- Left: List of mails -->
  <div class="col-lg-7 connectedSortable">
    <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h3 class="card-title mb-0">List of mails</h3>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          data-lte-toggle="card-collapse"
        >
          <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
          <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
        </button>
      </div>
      <div class="card-body p-0">
        <ul id="mailList" class="list-group list-group-flush">
          <!-- mails inserted here -->
        </ul>
      </div>
    </div>
  </div>

  <!-- Right: Mail preview + analyze -->
  <div class="col-lg-5">
    <div class="card bg-white border-light mb-4 shadow-sm" id="mailPreviewCard">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>
          <h5 class="mb-0 text-dark" id="previewFrom">Nouveau message</h5>
          <small class="text-muted" id="previewEmail">De: john.doe@example.com</small>
        </div>
        <div class="card-tools">
          <button
            type="button"
            class="btn btn-outline-secondary btn-sm"
            data-lte-toggle="card-collapse"
            aria-label="Afficher/Masquer le contenu"
          >
            <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
            <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
          </button>
        </div>
      </div>
      <div class="card-body">
        <p class="text-muted mb-2"><strong>Objet:</strong> <span id="previewSubject">Rapport hebdomadaire</span></p>
        <p class="text-dark" id="previewBody">
          Bonjour, voici le rapport d'analyse des emails de cette semaine. Merci de bien vouloir confirmer réception.
        </p>

        <!-- Analyze section -->
        <div class="mt-4 text-center">
          <button id="analyzeBtn" class="btn mb-3" style="background-color: #d63384; color: white;">ANALYZE</button>

          <div id="analysisResult" class="mb-3 text-primary fw-bold"></div>

          <div>
            <span>Êtes-vous satisfait de l'analyse ?</span><br />
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="satisfaction" id="satisYes" value="yes" />
              <label class="form-check-label" for="satisYes">Oui</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="satisfaction" id="satisNo" value="no" />
              <label class="form-check-label" for="satisNo">Non</label>
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer text-end">
        <a href="#" class="btn btn-primary btn-sm" id="previewLink" target="_blank" style="display:none">Voir l'email</a>
      </div>
    </div>
  </div>
</div>

<!-- Your mail archive inside a script tag -->
<script id="mailData" type="text/plain">
[IMPORTANT]
From: alice@example.com
To: moi@monemail.com
Date: 2025-05-25 09:15
Subject: Réunion urgente demain

Bonjour,

Nous avons une réunion urgente demain à 10h00 pour finaliser le projet.  
Merci de préparer les documents nécessaires.

Cordialement,  
Alice

--------------------------------------------

[IMPORTANT]
From: bob@example.com
To: moi@monemail.com
Date: 2025-05-24 14:30
Subject: Projet finalisé, à valider

Salut,

Le projet est maintenant finalisé.  
Peux-tu vérifier les derniers points et me confirmer que tout est bon ?  

Merci,  
Bob

--------------------------------------------

[SPAM]
From: promo123@spamdomain.com
To: moi@monemail.com
Date: 2025-05-26 08:00
Subject: Offre incroyable à ne pas rater !!!

Gagnez 1000€ chaque jour en cliquant ici !  
Offre limitée, dépêchez-vous !  
Cliquez sur ce lien magique : http://spamlink.fake

--------------------------------------------

[IMPORTANT]
From: carol@example.com
To: moi@monemail.com
Date: 2025-05-23 17:45
Subject: Compte rendu du rendez-vous client

Bonjour,

Voici le compte rendu de notre rendez-vous avec le client XYZ.  
Le projet avance comme prévu, la prochaine étape est la validation du cahier des charges.

Bonne journée,  
Carol

--------------------------------------------

[SPAM]
From: freegift@spamoffers.com
To: moi@monemail.com
Date: 2025-05-25 11:00
Subject: Vous avez gagné un cadeau gratuit !

Félicitations ! Vous avez gagné un cadeau gratuit.  
Cliquez ici pour réclamer votre prix avant qu’il ne soit trop tard !

--------------------------------------------

[IMPORTANT]
From: david@example.com
To: moi@monemail.com
Date: 2025-05-22 10:20
Subject: Mise à jour importante du système

Bonjour,

Une mise à jour critique du système aura lieu ce week-end.  
Veuillez sauvegarder vos données avant vendredi soir.

Merci,  
David

--------------------------------------------

[SPAM]
From: cheapmeds@pharmspam.com
To: moi@monemail.com
Date: 2025-05-26 13:00
Subject: Médicaments à prix cassés

Achetez vos médicaments sans ordonnance à prix cassés !  
Livraison rapide et discrète. Visitez notre site maintenant.

--------------------------------------------

[IMPORTANT]
From: emma@example.com
To: moi@monemail.com
Date: 2025-05-21 15:10
Subject: Invitation conférence 2025

Cher(e) collègue,

Vous êtes invité(e) à la conférence annuelle 2025 sur l’innovation technologique.  
Merci de confirmer votre présence avant le 30 mai.

Cordialement,  
Emma

--------------------------------------------

[SPAM]
From: lotterywin@fakeemail.com
To: moi@monemail.com
Date: 2025-05-26 09:00
Subject: Félicitations, vous avez gagné la loterie !

Vous êtes le grand gagnant de notre loterie internationale.  
Envoyez vos coordonnées pour recevoir votre prix immédiatement.

--------------------------------------------

[IMPORTANT]
From: frank@example.com
To: moi@monemail.com
Date: 2025-05-20 11:30
Subject: Problème détecté sur le serveur

Bonjour,

Un problème a été détecté sur le serveur principal.  
L’équipe technique travaille à sa résolution.

Cordialement,  
Frank

--------------------------------------------

[SPAM]
From: quickcash@spamfast.com
To: moi@monemail.com
Date: 2025-05-19 16:45
Subject: Gagnez de l'argent rapidement !

Profitez de notre méthode exclusive pour gagner de l'argent rapidement !  
Inscrivez-vous maintenant et recevez un bonus.

--------------------------------------------

[IMPORTANT]
From: gina@example.com
To: moi@monemail.com
Date: 2025-05-18 09:00
Subject: Validation budget Q3

Salut,

Le budget pour le troisième trimestre doit être validé avant la fin du mois.  
Peux-tu regarder les documents envoyés et me donner ton retour ?

Merci,  
Gina

--------------------------------------------

[SPAM]
From: miraclecure@spamhealth.com
To: moi@monemail.com
Date: 2025-05-15 08:30
Subject: Remède miracle contre toutes les maladies

Essayez notre remède miracle, approuvé par des experts.  
Commandez maintenant avec une remise exclusive !

--------------------------------------------

[IMPORTANT]
From: isabelle@example.com
To: moi@monemail.com
Date: 2025-05-14 13:15
Subject: Organisation séminaire client

Bonjour,

Le séminaire client aura lieu le 15 juin.  
Merci de confirmer ta participation et tes besoins logistiques.

Cordialement,  
Isabelle

--------------------------------------------


[IMPORTANT]
From: julien@example.com
To: moi@monemail.com
Date: 2025-05-12 11:55
Subject: Nouvelle politique de sécurité

Salut,

Nous avons mis à jour la politique de sécurité informatique.  
Merci de lire le document joint et de respecter les nouvelles règles.

Merci,  
Julien

--------------------------------------------

[SPAM]
From: cheaploans@spamfinance.com
To: moi@monemail.com
Date: 2025-05-11 15:25
Subject: Prêts personnels à taux réduit

Obtenez un prêt personnel rapidement avec un taux réduit.  
Sans justificatif, réponse immédiate.

--------------------------------------------

</script>

<script>
  // Parse mails including type (IMPORTANT or SPAM)
  function parseArchive(text) {
    const mailsRaw = text.trim().split('--------------------------------------------');
    return mailsRaw.map(raw => {
      const lines = raw.trim().split('\n');
      if (lines.length < 6) return null;

      let type = '';
      let i = 0;
      if (lines[0].startsWith('[')) {
        type = lines[0].replace(/\[|\]/g, '').toUpperCase();
        i++;
      }

      let from = '', to = '', date = '', subject = '', bodyLines = [];
      for (; i < lines.length; i++) {
        const line = lines[i].trim();
        if (line.startsWith('From:')) from = line.substring(5).trim();
        else if (line.startsWith('To:')) to = line.substring(3).trim();
        else if (line.startsWith('Date:')) date = line.substring(5).trim();
        else if (line.startsWith('Subject:')) {
          subject = line.substring(8).trim();
          i++;
          break;
        }
      }

      bodyLines = lines.slice(i).map(l => l.trim());
      const body = bodyLines.join('\n');

      return { type, from, to, date, subject, body };
    }).filter(m => m !== null);
  }

  // Show mail list in the left panel
  function displayMails(mails) {
    const ul = document.getElementById('mailList');
    ul.innerHTML = '';
    mails.forEach(mail => {
      const li = document.createElement('li');
      li.className = 'list-group-item d-flex justify-content-between align-items-start';
      li.style.cursor = 'pointer';
      li.innerHTML = `
        <div>
          <strong>${mail.from}</strong> — <span class="text-muted">${mail.subject}</span>
          <div class="text-truncate text-muted small">${mail.body.substring(0, 60).replace(/\n/g, ' ') + '...'}</div>
        </div>
        <small class="text-muted">${mail.date.split(' ')[1] || mail.date}</small>
      `;
      li.addEventListener('click', () => showMailPreview(mail));
      ul.appendChild(li);
    });
  }

  // Show selected mail details in preview and update mail type field
  function showMailPreview(mail) {
    document.getElementById('previewFrom').textContent = mail.from;
    document.getElementById('previewEmail').textContent = 'De: ' + mail.from;
    document.getElementById('previewSubject').textContent = mail.subject;
    document.getElementById('previewBody').textContent = mail.body;
    // Store mail type in a data attribute (hidden)
    document.getElementById('mailPreviewCard').dataset.mailType = mail.type || '';

    // Clear satisfaction radios on new mail
    document.querySelectorAll('input[name="satisfaction"]').forEach(el => el.checked = false);

    // Clear previous analysis result
    document.getElementById('analysisResult').textContent = '';
  }

  // ANALYZE button click handler
  document.getElementById('analyzeBtn').addEventListener('click', () => {
    const mailType = document.getElementById('mailPreviewCard').dataset.mailType || 'Inconnu';

    let resultText = '';
    if (mailType === 'IMPORTANT') resultText = 'Ce mail est important.';
    else if (mailType === 'SPAM') resultText = 'Ce mail est un spam.';
    else resultText = 'Type de mail inconnu.';

    document.getElementById('analysisResult').textContent = resultText;
  });

  // Load and display mails on page load
  const mailText = document.getElementById('mailData').textContent;
  const mails = parseArchive(mailText);
  displayMails(mails);

  // Show first mail by default if any
  if (mails.length > 0) {
    showMailPreview(mails[0]);
  }
</script>
 
            </div>
            <!-- /.row (main row) -->
          </div>
          <!--end::Container-->
        </div>
        <!--end::App Content-->
      </main>
      <!--end::App Main-->
      <!--begin::Footer-->
      <footer class="app-footer">
        <!--begin::To the end-->
        <div class="float-end d-none d-sm-inline">ESGI PA 2025</div>
        <!--end::To the end-->
        <!--begin::Copyright-->
       
        Mail Filter 
        <!--end::Copyright-->
      </footer>
      <!--end::Footer-->
    </div>
    <!--end::App Wrapper-->
    <!--begin::Script-->

</html>
